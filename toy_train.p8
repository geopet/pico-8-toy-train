pico-8 cartridge // http://www.pico-8.com
version 18
__lua__
-- toy train
-- by geopet (geoff petrie)

function _init()
  cls()
  switch_state=0
  train={{64,8},{72,8},{80,8}}
end

function _update()
  if (btnp(4)) then
    adv_switch()
  end

  move_train()
end

function move_segment(s,dir)
  spd=dir*2
  if (s[2]==8) then -- top side
    if (s[1]==112) then -- top right
      s[2]+=spd
    else
      s[1]+=spd
    end
  else
    if (s[1]==112) then -- right side
      if (s[2]==112) then -- bottom right
        s[1]-=spd
      else
        s[2]+=spd
      end
    else
      if (s[2]==112) then -- bottom side
        if (s[1]==8) then -- bottom side
          s[2]-=spd
        else
          s[1]-=spd
        end
      else
        if (s[1]==8) then -- left side
          if (s[2]==8) then -- top left
            s[1]+=spd
          else
            s[2]-=spd
          end
        end
      end
    end
  end
end

function adv_switch()
  if (switch_state<1) then
    switch_state+=1
  else
    switch_state=0
  end
end

function move_train()
  for t in all (train) do
    move_segment(t,switch_state)
  end
end

function draw_train()
  local len=count(train)

  for t=1,len do
    if (t==1) then
      sprite=11
    else
      if (t==len) then
        sprite=13
      else
        sprite=12
      end
    end
    spr(sprite,train[t][1],train[t][2])
  end
end

__gfx__
00000000444444444454444400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000444444444455444400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00700700454444444445444400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00077000455444444445444400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00077000445544444445544400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00700700445444444444444400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000444444444444444400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000444444444444444400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000444444544444444400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000444444544444444400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000444445544444444400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000444455444445554400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000444454444455444400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000444554444554444400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000455544445544444400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000454444444444444400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
