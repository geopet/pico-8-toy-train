pico-8 cartridge // http://www.pico-8.com
version 18
__lua__
-- toy train
-- by geopet (geoff petrie)

function _init()
  cls()
  switch_state=0
  train={{64,8},{72,8},{80,8}}
end

function _update()
  if (btnp(4)) then
    adv_switch()
  end

  move_train()
end

function move_segment(s,dir)
  spd=dir*2
  if (s[2]==8) then -- top side
    if (s[1]==112) then -- top right
      s[2]+=spd
    else
      s[1]+=spd
    end
  else
    if (s[1]==112) then -- right side
      if (s[2]==112) then -- bottom right
        s[1]-=spd
      else
        s[2]+=spd
      end
    else
      if (s[2]==112) then -- bottom side
        if (s[1]==8) then -- bottom side
          s[2]-=spd
        else
          s[1]-=spd
        end
      else
        if (s[1]==8) then -- left side
          if (s[2]==8) then -- top left
            s[1]+=spd
          else
            s[2]-=spd
          end
        end
      end
    end
  end
end

function adv_switch()
  if (switch_state<1) then
    switch_state+=1
  else
    switch_state=0
  end
end

function move_train()
  for t in all (train) do
    move_segment(t,switch_state)
  end
end

function draw_train()
  local len=count(train)

  for t=1,len do
    if (t==1) then
      sprite=11
    else
      if (t==len) then
        sprite=13
      else
        sprite=12
      end
    end
    spr(sprite,train[t][1],train[t][2])
  end
end

__gfx__
0000000000000000444544444444444444444444444444444444444466666766bbbbbbbbbbbbbbbbbbbbbbbbcccccccccccccccccccccccc0000000000000000
00000000000000004444554444444444466666666666666666666664656d6676bbbbbbbbbbbbbbbbbbbbbbbbcddddddccddddddccddddddc0000000000000000
0070070000000000444445544444444446555555555555555555556466666666bbbbbbbbbbbbbbbbbbbbbbbbcdccccdccdccccdccdccccdc0000000000000000
0007700000000000444444554444445446566466646646646664656466656766bbbbbbbbbbbbbbbbbbbbbbbbcdccccdccdcddcdccdc11cdc0000000000000000
0007700000000000444444444444455446546466646646646646656466766666bbbbbbbbbbbbbbbbbbbbbbbbcdccccdccdcddcdccdc11cdc0000000000000000
0070070000000000444444444444454446564555555555555556656466666656bbbbbbbbbbbbbbbbbbbbbbbbcdccccdccdccccdccdccccdc0000000000000000
0000000000000000444544444444454446566566666666666656656466565666bbbbbbbbbbbbbbbbbbbbbbbbcddddddccddddddccddddddc0000000000000000
0000000000000000444554444444454446544564444444444654456467666666bbbbbbbbbbbbbbbbbbbbbbbbcccccccccccccccccccccccc0000000000000000
0000000000000000444455444444455446566564488884444656656444488884bbbbbbbbbbbbbbbbbbbbbbbb0000000000000000000000000000000000000000
0000000000000000444445544444445446566564448778444656656444877844bbbbbbbbbbbbbbbbbbbbbbbb0000000000000000000000000000000000000000
0000000000000000444445544444444446566564444877844654456448778444bbbbbbbbbbbbbbbbbbbbbbbb0000000000000000000000000000000000000000
0000000000000000444455444444455446544564444487784656656487784444bbbbbbbbbbbbbbbbbbbbbbbb0000000000000000000000000000000000000000
0000000000000000444554444444554446566564444487784656656487784444bbbbbbbbbbbbbbbbbbbbbbbb0000000000000000000000000000000000000000
0000000000000000445544444455544446566564444877844654456448778444bbbbbbbbbbbbbbbbbbbbbbbb0000000000000000000000000000000000000000
0000000000000000445444444454444446566564448778444656656444877844bbbbbbbbbbbbbbbbbbbbbbbb0000000000000000000000000000000000000000
0000000000000000445444444444444446544564488884444656656444488884bbbbbbbbbbbbbbbbbbbbbbbb0000000000000000000000000000000000000000
bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb46566564444444444654456466766666bbbbbbbbbbbbbbbb000000000000000000000000000000000000000000000000
bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb46566566666666666656656469959996bbbbbbbbbbbbbbbb000000000000000000000000000000000000000000000000
bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb46544555555555555554656469995996bbbbbbbbbbbbbbbb000000000000000000000000000000000000000000000000
bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb46566466466466466466456469555596bbbbbbbbbbbbbbbb000000000000000000000000000000000000000000000000
bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb46564666466466466466656469555596bbbbbbbbbbbbbbbb000000000000000000000000000000000000000000000000
bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb46555555555555555555556469995996bbbbbbbbbbbbbbbb000000000000000000000000000000000000000000000000
bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb46666666666666666666666469959996bbbbbbbbbbbbbbbb000000000000000000000000000000000000000000000000
bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb44444444444444444444444466666676bbbbbbbbbbbbbbbb000000000000000000000000000000000000000000000000
bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb66666766666666766766666666666766bbbbbbbbbbbbbbbb000000000000000000000000000000000000000000000000
bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb656d69959995656666565995599d6676bbbbbbbbbbbbbbbb000000000000000000000000000000000000000000000000
bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb66666999599666666666695995966666bbbbbbbbbbbbbbbb000000000000000000000000000000000000000000000000
bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb66656955559667666676659959556766bbbbbbbbbbbbbbbb000000000000000000000000000000000000000000000000
bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb66766955559656666665659599566666bbbbbbbbbbbbbbbb000000000000000000000000000000000000000000000000
bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb66666999599666666666695995966656bbbbbbbbbbbbbbbb000000000000000000000000000000000000000000000000
bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb665659959996d656656d699559965666bbbbbbbbbbbbbbbb000000000000000000000000000000000000000000000000
bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb67666666667666666666676667666666bbbbbbbbbbbbbbbb000000000000000000000000000000000000000000000000
